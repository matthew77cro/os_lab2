
<!-- saved from url=(0057)http://zemris.fer.hr/predmeti/os/pripreme/z2_Lamport.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-2">
<title>Lamportov postupak - upute</title>
</head>
<body lang="EN-GB" style="">
<h2>Lamportov<b> postupak meðusobnog iskljuèivanja</b></h2><p>Uz pomoæ 
Lamportovog algoritma moguæe je sinkronizirati dvije ili vi¹e dretvi, odnosno 
dva ili vi¹e procesa koji primjerice mogu izgledaju ovako:</p>

<pre><u>proces</u> proc(<b>i</b>){&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /* <b>i</b>&nbsp; [0..n] */
   ponavljaj{
   &nbsp;&nbsp; <b>uði u kritièni odsjeèak;</b>
      K.O.;
    &nbsp; <b>izaði iz kritiènog odsjeèka;
</b>      N.K.O.;
   }dok je zadovoljen(uvjet);
}</pre>
<h3>Lamportov<b> algoritam:</b></h3>

<pre style="margin: 0cm 0cm 0.0001pt; font-size: 10pt; font-family: Courier New;"><u>zajednièke varijable</u>: ULAZ[0..<b>n</b>-1], BROJ[0..<b>n</b>-1]</pre>
<pre><u>funkcija</u> uði_u_kritièni_odsjeèak(i)
{
&nbsp;&nbsp; ULAZ[<b>i</b>] = 1;
&nbsp;&nbsp; BROJ[<b>i</b>] = <b>max</b>(BROJ[0],...,BROJ[<b>n</b>-1]) + 1;
&nbsp;&nbsp; ULAZ[<b>i</b>] = 0;

&nbsp;&nbsp; <u>za</u> <b>j</b> = 0 <u>do</u> <b>n</b>-1 <u>èini</u>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <u>dok je</u> ULAZ[<b>j</b>] &lt;&gt; 0 <u>èini</u>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <u>ni¹ta;</u>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <u>dok je</u> BROJ[j] &lt;&gt; 0 &amp;&amp; (BROJ[j] &lt; BROJ[i] || (BROJ[j] == BROJ[i] &amp;&amp; j &lt; i)) <u>èini</u>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <u>ni¹ta;
</u>}
&nbsp;
<u>funkcija</u> izaði_iz_kritiènog_odsjeèka(i)
{
   BROJ[<b>i</b>] = 0;
}</pre>
<p style=""><b>Dodatne upute:</b></p>
<p><font color="#FF0000">Ako se program rje¹ava s procesima tada treba zajednièke varijable tako organizirati da se prostor za njih zauzme odjednom i podijeli meðu njima. Ovo je nu¾no zbog ogranièenog broja segmenata i velikog broja korisnika.</font></p>

<p>Ovisno o optereæenju raèunala i broju procesa koji se pokreæu, a da bi se vidjele razlike prilikom izvoðenja programa mo¾e 
se usporiti izvr¹avanje programa sa:</p>

<pre>sleep(1);</pre><p>na kraju kritiènog odsjeèka (K.O.).</p>

<p><b><a name="Problem"></a>Problemi zbog izvoðenja instrukcija "preko reda"</b></p>
<p>Za ispravan rad Dekkerovog, Petersonovog i Lamportovog algoritma 
pretpostavlja se da se instrukcije programa izvode zadanim redoslijedom. Meðutim, 
neki procesori, kako bi ubrzali izvoðenje programa, dozvoljavaju izvoðenje 
instrukcija i "preko reda" (engl. <i>out-of-order</i>). Takvo pona¹anje mo¾e 
uzrokovati gre¹ke u algoritmu meðusobnog iskljuèivanja.</p>
<p>Primjerice, prilikom izvoðenja Lampotovog algoritma mo¾e se dogoditi da se 
sljedeæi niz instrukcija ne izvodi zadanim redoslijedom.</p>
<pre>1:   ULAZ[i] = 1;
2:   BROJ[i] = max(BROJ[0],...,BROJ[n-1]) + 1;
3:   ULAZ[i] = 0;</pre>
<p>Procesor koji omoguæuje izvoðenje instrukcija "preko reda" bi nakon prve 
linije koda mogao ustanoviti da su instrukcije u drugoj i treæoj liniji 
meðusobno nezavisne i mogao bi ih izvesti proizvoljnim redosljedom, npr. liniju 
3 prije linije 2 (razlog za to mo¾e biti&nbsp; da se element
<font face="Courier New">ULAZ[i]</font> nalazi u priruènom spremniku, a
<font face="Courier New">BROJ[i]</font> ne). U tom se sluèaju ne radi vi¹e o 
Lamportovom algoritmu.</p>
<p>Kako bi se izbjeglo proizvoljno izvoðenje instrukcija mo¾e se jeziènom 
procesoru naznaèiti da je pristup spornim varijablama toèno odreðen programskim 
kodom na naèin da se varijabla proglasi tipom podataka <font face="Courier New">
atomic</font>:</p>
<p><font face="Courier New">#include <span lang="en-us">&lt;</span>stdatomic.h<span lang="en-us">&gt;<br>
atomic_int ULAZ[N], BROJ[N];</span></font></p>
<p>&nbsp;</p>
<pre>&nbsp;</pre>

</body></html>